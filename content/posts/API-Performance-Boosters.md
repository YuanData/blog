---
title: "API效能優化技巧"
date: 2023-10-13T09:00:00+08:00
draft: false
tags: ["System Design", "API"]
---
### 增強API校能的各種技巧<br>Key Techniques to Enhance API Performance
| 摘要 | 内容 |
|-----|------|
| 優化(Optimization)的先決條件|優化不應該是過程的第一步。首先應該通過負載測試和請求分析來確定實際的瓶頸，只有當確認API端點存在性能問題時，才開始進行優化。|
| 緩存(Caching)|緩存是加快API速度的最有效方法之一。可以存儲昂貴計算的結果，以便稍後再使用而不需要重新計算。可以使用Redis或Memcached來緩存反應，以避免反覆訪問數據庫。|
| 連接池(Connection Pooling)|通過維護一個開放的連接池，而不是為每個API呼叫打開一個新的數據庫連接，可以大大提高吞吐量。對於使用無伺服器架構的情況，連接管理可能更具挑戰性。例如，AWS RDS Proxy和Azure SQL Database serverless可以為你管理連接池。|
| 避免N+1查詢問題(Avoid N+1 queries)|當訪問一個實體及其相關實體的數據時，可能會出現N+1問題。例如，如果要提取博客文章及其評論，應該使用單一查詢或兩個查詢（一個查詢文章，另一個查詢該文章的所有評論）來提取數據，以避免為每個帖子的評論進行單獨的查詢。|
| 分頁(Pagination)|如果API回應返回大量數據，可以使用分頁來加速數據傳輸並減少客戶端的負擔。|
| 使用輕量級JSON序列化(Lightweight Serializers)|當從API返回JSON回應時，序列化過程的速度可能會影響回應時間。考慮使用一個快速的序列化庫來將數據轉換成JSON格式。|
| 壓縮(Compression)|通過在大的API回應負載上啟用壓縮，可以減少網絡上傳輸的數據量。現在有像Brotli這樣的更高效的算法，提供更好的壓縮比率。很多內容交付網絡（CDNs）像Cloudflare可以幫助你處理壓縮，從你的伺服器上卸載這個任務。|
| 異步日誌(Asynchronous Logging)|在許多應用程序中，寫日誌的時間可以忽略不計。但在高吞吐量系統中，寫日誌的時間可能會累計。異步日誌可以幫助解決這個問題，這涉及主應用程序線程快速地將日誌條目放入內存緩存，而一個單獨的日誌線程將日誌條目寫入文件或發送到日誌服務。|
